<!doctype html>
<html lang="en">
  <head>
    <title>NSFW</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="main.css">
  </head>
  <body>
    <div id="player"></div>
    <div class="general-container" id="app">
      <general-canvas ref="generalCanvas" :width="width" :height="height"></general-canvas>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script>
      var tag = document.createElement('script')
      tag.src = "https://www.youtube.com/iframe_api"
      var firstScriptTag = document.getElementsByTagName('script')[0]
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag)
      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: '360',
          width: '640',
          videoId: 'I_izvAbhExY',
        });
      }
    </script>
    <script>
      Vue.component('general-canvas', {
        template: '<canvas ref="canvasElement" class="general-canvas" :width="width" :height="height"></canvas>',
        props: ['width', 'height'],
        data: function () {
          return {
            isMounted: false,
            canvasElement: {},
            canvas: {},
            sprites: [],
            elements: [],
            mainElement: {}
          }
        },
        mounted: function () {
          this.canvasElement = this.$refs.canvasElement
          this.canvas = this.canvasElement.getContext('2d')
          this.loadSprites()
          this.isMounted = true
        },
        methods: {
          init() {
            setInterval(() => {
              this.renderCanvas()
            }, 90)
          },
          loadSprites() {
            for (var i = 0; i < 48; i++) {
              var img = new Image();
              img.src = 'sprites/sprite_'+i+'.png'
              this.sprites.push(img)
            }
          },
          renderCanvas() {
            this.canvas.clearRect(0, 0, this.canvasElement.width, this.canvasElement.height)
            this.canvas.drawImage(this.sprites[0], 0, 0, 500, 500)
          }
        }
      })

      var app = new Vue({
        el: '#app',
        data: function () {
          return {
            isMounted: false,
            width: window.innerWidth,
            height: window.innerHeight
          }
        },
        mounted: function () {
          window.addEventListener('resize', this.resizeController, { passive: true })
          this.isMounted = true
        },
        beforeDestroy: function () {
          window.removeEventListener('scroll', this.scrollController, { passive: true })
          window.removeEventListener('resize', this.resizeController, { passive: true })
        },
        methods: {
          resizeController() {
            if (this.isMounted) {
              this.width = window.innerWidth
              this.height = window.innerHeight
              if(this.width > 768 && this.isHamburguerActive) {
                this.isHamburguerActive = !this.isHamburguerActive
              }
            }
          },
        }
      })
    </script>
  </body>
</html>